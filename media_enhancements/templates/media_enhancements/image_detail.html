{% extends "media_enhancements/base.html" %}
{% load static %}

{% block title %}{{ image.title }} - Image Details{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12 mb-3">
        <a href="{% url 'media_enhancements:unified_dashboard' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <img src="{{ image.file.url }}" alt="{{ image.title }}" class="card-img-top" style="max-height: 600px; object-fit: contain;">
            <div class="card-body">
                <h2 class="card-title">{{ image.title }}</h2>
                
                {% if image.alt_text_override %}
                <div class="alert alert-info">
                    <strong>Alt Text:</strong> {{ image.alt_text_override }}
                </div>
                {% endif %}
                
                <div class="mt-3">
                    <a href="{% url 'media_enhancements:image_editor' image.id %}" class="btn btn-success btn-lg">
                        <i class="fas fa-magic"></i> Edit Image
                    </a>
                    <a href="{{ image.file.url }}" class="btn btn-primary" download>
                        <i class="fas fa-download"></i> Download Original
                    </a>
                    <a href="/admin/images/{{ image.id }}/" class="btn btn-warning">
                        <i class="fas fa-cog"></i> Edit Metadata
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <!-- Image Information -->
        <div class="card mb-3">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-info-circle"></i> Image Information</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm">
                    <tr>
                        <th>Uploaded:</th>
                        <td>{{ image.created_at|date:"M d, Y H:i" }}</td>
                    </tr>
                    <tr>
                        <th>File Size:</th>
                        <td>{{ image.file.size|filesizeformat }}</td>
                    </tr>
                    <tr>
                        <th>Dimensions:</th>
                        <td>{{ image.width }} × {{ image.height }}px</td>
                    </tr>
                    <tr>
                        <th>Format:</th>
                        <td>{{ image.file.name|slice:"-4:" }}</td>
                    </tr>
                    {% if image.copyright_holder %}
                    <tr>
                        <th>Copyright:</th>
                        <td>{{ image.copyright_holder }}</td>
                    </tr>
                    {% endif %}
                    {% if image.source_url %}
                    <tr>
                        <th>Source:</th>
                        <td><a href="{{ image.source_url }}" target="_blank">View Source</a></td>
                    </tr>
                    {% endif %}
                </table>
            </div>
        </div>
        
        <!-- Categories -->
        {% if categories %}
        <div class="card mb-3">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-tags"></i> Categories</h5>
            </div>
            <div class="card-body">
                {% for category in categories %}
                <a href="{% url 'media_enhancements:category_media' category.slug %}" class="badge bg-secondary me-1 mb-1">
                    {{ category.name }}
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <!-- Tags -->
        {% if tags %}
        <div class="card mb-3">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-hashtag"></i> Tags</h5>
            </div>
            <div class="card-body">
                {% for tag in tags %}
                <span class="badge bg-light text-dark me-1 mb-1">{{ tag.name }}</span>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <!-- Available Renditions -->
        <div class="card">
            <div class="card-header bg-warning">
                <h5 class="mb-0"><i class="fas fa-images"></i> Available Sizes</h5>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <a href="{{ image.file.url }}" class="list-group-item list-group-item-action" target="_blank">
                        Original ({{ image.width }}×{{ image.height }})
                    </a>
                </div>
                <small class="text-muted mt-2 d-block">
                    Additional renditions can be generated through Wagtail's image serving system.
                </small>
            </div>
        </div>
    </div>
</div>
{% endblock %}
